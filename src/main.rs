type Voter = Vec<i32>;
type Table = Vec<Voter>;

fn b(q: f32) -> f32 {
	if q == 0.0 || q == 1.0 {
		0.0
	} else {
		let inv = 1.0 - q;
		-(q * q.log2() + inv * inv.log2())
	}
}

fn remainder(data: &Table, attribute: usize) -> f32 {
	let total = data.len() as f32;
	let total_k = data.iter().fold(0, |a, b| a + b[attribute]) as f32;
	let total_nk = total - total_k;
	let positive_k = data.iter().fold(0, |a, b| a + if b[0] == 1 && b[attribute] == 1 {1} else {0}) as f32;
	let positve_nk = data.iter().fold(0, |a, b| a + if b[0] == 1 && b[attribute] == 0 {1} else {0}) as f32;

	total_k / total * b(positive_k / total_k) + total_nk / total * b(positve_nk / total_nk)

}

fn gain(data: &Table, attribute: usize) -> f32 {
	let positive = data.iter().fold(0, |a, b| a + b[0]) as f32;
	let total = data.len() as f32;

	b(positive / total) - remainder(data, attribute)
}

fn main() {
	let data = vec![
		vec![0,0,1,1,0,1,1,0,0,0,0,0,0,1,1,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![1,1,0,0,1,1,0,1,1,1,0,0,1,1,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![0,1,1,1,0,0,0,1,1,1,1,0,0,1,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,1,1,0,1,1,1,0,0,0,0,0,0,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![0,1,0,1,0,0,0,1,1,1,1,1,0,1,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1],
		vec![0,1,1,1,0,0,0,1,1,0,0,0,0,0,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![1,1,1,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![1,0,1,0,1,1,1,0,0,0,1,1,1,1,1,0,0],
		vec![1,0,1,0,1,1,1,0,0,0,1,1,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![0,1,1,1,0,0,0,1,1,1,0,1,0,0,0,0,1],
		vec![1,1,1,0,1,1,1,1,0,0,0,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,1,0,0,0,1,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![1,1,1,1,1,0,0,1,1,1,1,1,0,0,1,0,1],
		vec![1,1,0,1,1,1,0,1,0,1,1,0,0,1,1,0,1],
		vec![0,1,0,1,0,0,1,1,1,1,1,1,0,0,1,1,1],
		vec![0,0,1,1,1,1,1,0,0,0,1,1,0,1,1,0,0],
		vec![0,0,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1],
		vec![0,1,1,1,0,1,1,0,0,0,1,1,0,1,1,0,1],
		vec![1,0,0,0,1,1,0,0,0,0,1,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![0,0,0,1,0,1,1,0,0,0,1,1,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![0,0,1,1,0,1,1,1,0,1,1,1,0,1,1,0,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,1,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,0,1,1,1,0,0,0,1,1],
		vec![0,1,0,1,0,1,1,0,0,0,0,0,0,0,0,0,1],
		vec![0,1,0,0,0,1,1,1,0,0,1,1,0,0,1,0,1],
		vec![0,1,1,1,0,0,1,1,1,1,1,0,0,0,0,0,1],
		vec![0,1,0,0,0,1,1,0,0,0,0,1,1,0,1,0,1],
		vec![0,1,0,1,0,1,1,1,0,0,0,1,0,0,1,0,1],
		vec![0,1,1,1,0,0,0,0,1,1,0,1,0,0,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,0,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![1,1,1,1,1,1,0,1,0,0,0,0,1,1,1,0,1],
		vec![0,0,1,1,0,0,0,0,1,1,1,1,0,0,0,1,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,0,1,0,1],
		vec![0,0,0,1,0,0,1,0,1,1,1,0,0,0,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![1,0,1,0,1,1,1,0,0,0,1,1,1,1,0,0,1],
		vec![0,0,0,1,0,0,1,1,1,1,1,0,0,0,1,0,1],
		vec![0,1,0,1,0,0,1,1,1,1,0,0,0,0,0,1,1],
		vec![1,0,0,0,1,0,0,1,1,1,1,0,0,1,1,0,1],
		vec![1,0,0,0,1,1,1,1,1,1,1,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,0,0,0,0,0,0,1,1,1,1,0,1,1,1,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,1,1,1,1,0,1],
		vec![0,0,0,1,0,0,0,1,1,1,1,0,0,1,0,1,1],
		vec![1,1,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![0,0,1,1,0,0,1,0,1,1,1,1,0,1,0,1,1],
		vec![0,0,0,1,0,0,1,1,1,1,1,1,0,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,1,1,0,1,1,1,1,0,0,0,0,1,1,1,0,0],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![0,0,1,0,0,1,1,0,0,0,0,0,1,1,1,1,1],
		vec![0,0,0,0,0,1,1,1,0,0,0,0,1,1,1,0,1],
		vec![0,0,1,1,0,1,1,1,0,0,0,1,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,1,0,0,0,0,1,1,1,0,1],
		vec![1,1,0,1,1,1,1,1,1,0,1,0,1,0,1,1,1],
		vec![1,1,0,1,1,1,1,1,1,0,1,1,1,0,1,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,1,0,0,1,0,1],
		vec![0,0,0,0,0,1,1,0,0,0,1,1,1,1,1,0,1],
		vec![0,0,1,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![1,0,0,1,1,0,0,1,1,1,1,0,0,0,1,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,1,1],
		vec![0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,1,1],
		vec![0,0,1,1,0,0,0,1,1,1,1,1,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,0,0,0,0,0,1,1,1,1,0,1,0,0,1,1,1],
		vec![0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,0,0,1,0,0,0,1,1,1,0,0,0,0,1,1,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,1,1,1,1,1,1,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![1,0,0,1,1,1,1,1,0,0,0,0,1,1,1,0,1],
		vec![0,0,0,1,0,0,1,1,1,1,1,0,1,0,0,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,0,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,1,1,0,0,0,0,1],
		vec![0,0,0,1,0,0,1,1,1,1,0,0,0,0,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![0,0,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![0,0,1,1,0,0,1,0,1,1,0,1,0,1,0,1,1],
		vec![1,1,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![0,0,1,1,0,0,0,0,1,1,0,1,0,0,1,1,1],
		vec![1,0,0,0,1,1,0,0,0,0,0,0,1,1,1,0,1],
		vec![0,0,0,1,0,0,1,1,1,1,0,1,0,0,1,1,1],
		vec![1,0,1,1,1,1,1,1,0,1,1,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,1,1,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,0,1,0,1],
		vec![0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,1,1,1,0,0,0,1,1,0,0,1],
		vec![1,0,0,0,1,1,1,1,0,0,1,0,0,0,1,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,1,0,0,1,1,1],
		vec![0,1,0,1,0,0,0,0,1,1,1,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,1,0,0,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![0,1,1,1,0,0,1,1,1,1,0,0,0,0,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,0,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,1,1,1],
		vec![1,0,0,0,1,1,0,0,0,0,0,0,1,0,1,0,0],
		vec![0,0,0,1,0,0,0,1,1,1,0,1,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,0,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,0,1,0,1],
		vec![1,1,0,0,0,0,0,1,1,1,1,0,0,0,1,0,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![1,1,0,0,1,1,0,1,0,0,1,0,0,0,1,1,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,1,0],
		vec![1,0,0,1,1,1,1,1,1,0,1,0,0,0,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![0,0,0,1,0,0,0,1,1,1,1,0,0,0,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,0,0,1,0,0,1,1,1,1,1,1,0,0,0,1,1],
		vec![0,1,1,1,0,1,1,0,1,0,1,1,0,1,1,1,1],
		vec![0,1,0,1,0,0,1,1,1,0,1,1,0,1,1,1,1],
		vec![0,1,1,1,0,0,1,1,1,1,1,1,0,1,1,1,1],
		vec![1,0,0,1,1,1,1,0,0,0,1,0,1,1,1,1,1],
		vec![0,0,1,0,0,0,0,1,1,1,1,1,0,0,0,1,1],
		vec![0,0,1,1,0,0,1,1,1,1,1,0,0,1,1,1,1],
		vec![1,0,0,0,1,1,0,1,1,1,1,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,1,0,0,1,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![0,1,0,0,0,0,1,1,1,1,1,0,0,0,1,1,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,1,0],
		vec![0,0,0,1,0,0,1,1,1,1,1,0,0,1,0,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![1,0,1,1,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,1,0,1,1,1,1,1,0,0,1,1,1,1,1,1],
		vec![0,0,0,0,0,0,1,0,1,1,0,1,1,1,1,1,0],
		vec![0,1,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![0,0,1,1,0,0,1,0,1,1,1,0,0,1,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,1,0,0,1,0,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,1,1,1,1,0,0],
		vec![0,1,1,0,1,0,0,1,1,1,0,1,0,0,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,1,0,0,0,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![0,0,0,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,0,0,0,0,0,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,1,1,1],
		vec![1,1,0,0,1,1,1,0,0,0,0,1,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,1,1,1,0,1,0,1],
		vec![1,0,0,0,1,1,0,1,0,1,1,0,0,0,1,0,1],
		vec![0,0,0,1,0,0,0,1,1,1,1,1,0,0,0,1,1],
		vec![1,0,0,0,1,1,1,1,0,0,1,0,1,0,1,1,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,1,0,0,1,1,1,0,0,0,1,0,1,1,1,0,0],
		vec![1,0,1,1,1,1,1,1,1,1,0,0,1,1,1,0,1],
		vec![0,0,1,0,0,0,1,1,0,1,0,1,0,0,0,1,1],
		vec![1,0,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1],
		vec![1,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,1],
		vec![1,1,0,1,1,0,0,0,1,1,1,0,0,0,1,1,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![0,1,0,1,0,0,1,1,1,1,1,0,0,1,0,0,1],
		vec![0,1,1,1,0,0,1,1,1,1,1,1,1,1,0,0,1],
		vec![1,1,1,0,1,1,1,0,0,0,1,1,0,1,0,0,0],
		vec![1,1,1,0,1,1,1,0,0,0,0,1,0,1,1,0,1],
		vec![0,0,1,0,0,1,1,0,0,0,1,1,0,1,1,0,0],
		vec![0,0,1,1,0,0,1,1,1,0,1,0,0,0,0,1,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,0,1,1,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,0,1,0,1,1,1,0,0,0,0,1,1,0,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,1,1,1,0,1,1,0,1,1,1,1,0,0,0,0,1],
		vec![0,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,1],
		vec![0,1,1,0,0,1,1,0,0,0,0,1,1,1,1,1,0],
		vec![0,1,1,0,0,0,0,0,1,1,0,1,0,0,0,1,0],
		vec![1,1,1,0,1,1,1,0,0,0,0,1,1,1,1,0,1],
		vec![0,1,1,1,0,1,1,0,1,0,0,1,0,1,0,1,1],
		vec![0,0,1,1,0,1,1,0,1,0,0,0,0,0,0,0,1],
		vec![1,0,1,0,1,1,1,0,0,0,1,1,1,1,1,0,0],
		vec![1,1,1,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,1],
		vec![0,1,0,1,0,1,1,0,0,1,1,0,0,1,1,0,1],
		vec![0,0,0,0,1,1,1,0,0,0,0,1,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,0,0,1,1,1,0,0],
		vec![1,0,0,0,1,1,1,0,0,0,0,1,1,1,1,0,1],
		vec![0,1,0,1,0,0,1,1,1,1,1,1,0,0,0,0,1],
		vec![1,0,0,0,1,1,1,0,0,0,1,0,1,1,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1],
		vec![1,1,1,0,1,1,1,0,0,0,1,0,0,1,1,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,1,1,0,1,0,0,1],
		vec![0,1,1,1,0,0,0,1,1,0,1,0,0,0,0,0,1],
		vec![0,1,1,1,0,0,0,1,1,1,0,0,0,0,0,0,1],
		vec![1,1,1,1,1,1,1,1,1,0,1,0,0,1,1,0,1],
		vec![0,0,1,1,0,1,1,1,1,0,0,1,0,1,0,1,1],
		vec![0,0,0,1,0,0,1,1,1,1,0,1,0,0,0,1,1],
		vec![0,0,1,1,0,0,1,1,1,1,0,1,0,0,1,1,1],
		vec![0,1,0,1,0,0,0,1,1,1,1,0,0,0,0,1,1],
		vec![1,0,0,0,1,1,1,1,1,0,1,0,1,1,1,0,1],
		vec![1,0,0,1,1,1,1,0,0,1,1,0,1,1,1,0,1],
		vec![0,0,0,1,0,0,0,1,1,1,1,0,0,0,0,0,1],
	];

	let mut info_per_attribute = Vec::new();

	for a in 1..17 {
		let gain = gain(&data, a);

		info_per_attribute.push((a, gain));
	}

	info_per_attribute.sort_unstable_by_key(|(_, g)| (g * 50000.0) as u16);
	let (best_attribute, best_gain) = info_per_attribute[info_per_attribute.len()-1];

	// let republicans = (data.len() as i32 - data.iter().fold(0, |a, b| a + b[0])) as f32;

	// println!("{republicans}");

	println!("Best split: attribute {best_attribute}, with gain: {best_gain}");
}
